<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#0ea5e9">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Hbee Outreach">
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiSGJlZSBPdXRyZWFjaCIsInNob3J0X25hbWUiOiJIYmVlIiwic3RhcnRfdXJsIjoiLyIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwiYmFja2dyb3VuZF9jb2xvciI6IiNmOGY5ZmEiLCJ0aGVtZV9jb2xvciI6IiMwZWE1ZTkiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhacFpYZENiM2c5SWpBZ01DQTFNREFnTURBd0lqNDhjR0YwYUNCa1BTSWlMejQ4TDNOMlp6ND0iLCJzaXplcyI6IjY0eDY0IiwidHlwZSI6ImltYWdlL3N2Zyt4bWwifV19">
    
    <!-- Primary Meta Tags -->
    <title>Hbee Outreach - Professional Bulk Email Tool</title>
    <meta name="description" content="Hbee Outreach: Professional bulk email tool with AI templates, smart automation, spam-free delivery, and advanced analytics.">
    <meta name="keywords" content="Hbee Outreach, email marketing, bulk emails, AI templates, email automation, spam-free, email campaigns">
    <meta name="author" content="Hbee Outreach Team">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:title" content="Hbee Outreach - AI-Powered Email Tool">
    <meta property="og:description" content="Advanced bulk email tool with AI templates, smart automation and spam-free delivery.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hbee-outreach.com">
    <meta property="og:image" content="https://hbee-outreach.com/assets/images/og-image.png">
    <meta property="og:site_name" content="Hbee Outreach">
    
    <!-- Twitter Cards Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Hbee Outreach - AI Email Templates">
    <meta name="twitter:description" content="Professional email outreach with AI templates and smart automation.">
    <meta name="twitter:image" content="https://hbee-outreach.com/assets/images/twitter-image.png">
    <meta name="twitter:site" content="@hbeeoutreach">
    <meta name="twitter:creator" content="@hbeeoutreach">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://hbee-outreach.com">

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 rx=%2220%22 fill=%22%230ea5e9%22/><path d=%22M50,30 L70,50 L50,70 L30,50 Z%22 fill=%22%23ffffff%22/></svg>">

    <!-- Remixicon -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
   
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        secondary: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d',
                        },
                        accent: {
                            500: '#8b5cf6',
                            600: '#7c3aed',
                        }
                    },
                    fontFamily: {
                        'inter': ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
                        'poppins': ['Poppins', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 3s ease-in-out infinite',
                        'pulse-glow': 'pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'slide-up': 'slide-up 0.3s ease-out',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        'pulse-glow': {
                            '0%, 100%': { opacity: 1 },
                            '50%': { opacity: 0.7 },
                        },
                        'slide-up': {
                            '0%': { transform: 'translateY(10px)', opacity: 0 },
                            '100%': { transform: 'translateY(0)', opacity: 1 },
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
    :root {
      --primary-500: #0ea5e9;
      --primary-600: #0284c7;
      --secondary-500: #22c55e;
      --secondary-600: #16a34a;
      --accent-500: #8b5cf6;
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
    }
    
    /* Base styling */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      font-size: 14px;
      font-weight: 400;
      line-height: 1.5;
      color: #1f2937;
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      min-height: 100vh;
      overflow-x: hidden;
    }

    .dark body {
      background: linear-gradient(135deg, #111827 0%, #1e293b 100%);
      color: #f9fafb;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      letter-spacing: -0.025em;
    }

    h1 { font-size: 2rem; }
    h2 { font-size: 1.5rem; }
    h3 { font-size: 1.25rem; }
    h4 { font-size: 1.125rem; }
  
    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { 
      background: rgba(0, 0, 0, 0.2); 
      border-radius: 2px;
      transition: background 0.3s ease;
    }
    .dark ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); }
    ::-webkit-scrollbar-thumb:hover { background: rgba(0, 0, 0, 0.3); }
    .dark ::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.3); }
    
    /* Button styles */
    .hbee-btn {
      background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
      color: white;
      border-radius: 10px;
      font-family: 'Inter', system-ui, sans-serif;
      font-weight: 600;
      font-size: 14px;
      padding: 12px 20px;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(14, 165, 233, 0.2);
      position: relative;
      overflow: hidden;
      touch-action: manipulation;
    }

    .hbee-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .hbee-btn:hover::before {
      left: 100%;
    }

    .hbee-btn:active {
      transform: scale(0.98);
    }
    
    .hbee-btn-secondary {
      background-color: white;
      color: var(--primary-500);
      border: 2px solid #e5e7eb;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .hbee-btn-secondary:hover {
      background-color: #f9fafb;
      border-color: var(--primary-500);
    }
    
    .hbee-btn-secondary:active {
      transform: scale(0.98);
    }
    
    .dark .hbee-btn-secondary {
      background-color: #1f2937;
      color: #7dd3fc;
      border-color: #374151;
    }
    
    /* Cards */
    .hbee-card {
      background-color: white;
      border-radius: 12px;
      border: 1px solid rgba(229, 231, 235, 0.8);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    .hbee-card:hover { 
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); 
    }
    
    .dark .hbee-card {
      background-color: rgba(31, 41, 55, 0.8);
      border-color: rgba(55, 65, 81, 0.8);
    }

    /* Inputs */
    .hbee-input {
      border-radius: 8px;
      border: 2px solid #e5e7eb;
      padding: 10px 14px;
      font-family: 'Inter', system-ui, sans-serif;
      font-size: 14px;
      transition: all 0.3s ease;
      background-color: white;
      width: 100%;
    }
    
    .hbee-input:focus {
      border-color: var(--primary-500);
      outline: none;
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
    }
    
    .dark .hbee-input {
      border-color: #4b5563;
      background-color: #374151;
      color: #f9fafb;
    }
    
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .animate-fadeIn { animation: fadeIn 0.3s ease forwards; }
    
    /* NEW: Compact Email List for Mobile */
    .email-link-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 10px;
      width: 100%;
      max-width: 100%;
      overflow: hidden;
    }
    
    .email-link-item {
      display: flex;
      align-items: center;
      padding: 10px 12px;
      background: white;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      transition: all 0.2s ease;
      cursor: pointer;
      text-decoration: none !important;
      color: inherit;
      width: 100%;
      max-width: 100%;
      overflow: hidden;
      touch-action: manipulation;
    }
    
    .email-link-item:active {
      transform: scale(0.98);
      background: #f0f9ff;
    }
    
    .email-link-item:hover {
      background: #f0f9ff;
      border-color: var(--primary-500);
    }
    
    .dark .email-link-item {
      background: rgba(31, 41, 55, 0.8);
      border-color: #374151;
      color: #f9fafb;
    }
    
    .dark .email-link-item:hover,
    .dark .email-link-item:active {
      background: rgba(14, 165, 233, 0.1);
      border-color: var(--primary-500);
    }
    
    .email-number {
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 28px;
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
      color: white;
      border-radius: 50%;
      font-size: 12px;
      font-weight: 600;
      margin-right: 12px;
      flex-shrink: 0;
    }
    
    .email-content {
      flex: 1;
      min-width: 0;
      overflow: hidden;
    }
    
    .email-address {
      font-size: 13px;
      font-weight: 500;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: block;
      width: 100%;
    }
    
    .email-status {
      font-size: 11px;
      font-weight: 600;
      margin-top: 2px;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    /* NEW: Real-time loading line */
    .loading-line {
      position: fixed;
      top: 0;
      left: 0;
      width: 0%;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-500), var(--secondary-500));
      z-index: 10000;
      transition: width 0.3s ease;
      box-shadow: 0 0 10px rgba(14, 165, 233, 0.5);
    }
    
    /* Status badges */
    .status-sent {
      color: #10b981;
    }
    
    .status-pending {
      color: #f59e0b;
    }
    
    /* Template chips */
    .template-chip {
      display: inline-flex;
      align-items: center;
      padding: 6px 12px;
      background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(34, 197, 94, 0.1));
      color: var(--primary-600);
      border-radius: 16px;
      font-size: 12px;
      font-weight: 500;
      margin-right: 6px;
      margin-bottom: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 1px solid transparent;
      touch-action: manipulation;
    }
    
    .template-chip:active {
      transform: scale(0.95);
    }
    
    .template-chip:hover {
      background: linear-gradient(135deg, rgba(14, 165, 233, 0.2), rgba(34, 197, 94, 0.2));
      border-color: var(--primary-500);
    }
    
    .dark .template-chip {
      background: linear-gradient(135deg, rgba(14, 165, 233, 0.2), rgba(34, 197, 94, 0.2));
      color: #7dd3fc;
    }
    
    /* AI Template Badge */
    .ai-badge {
      background: linear-gradient(135deg, #8b5cf6, #7c3aed);
      color: white;
      font-size: 9px;
      padding: 1px 6px;
      border-radius: 10px;
      margin-left: 6px;
    }
    
    /* Progress bar */
    .progress-bar-container {
      height: 6px;
      background-color: #e5e7eb;
      border-radius: 3px;
      overflow: hidden;
      width: 100%;
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-500), var(--secondary-500));
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }
    
    /* Floating action button */
    .fab {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
      opacity: 0;
      transform: scale(0) translateY(20px);
      border: none;
      touch-action: manipulation;
    }
    
    .fab.visible {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
    
    .fab:active {
      transform: scale(0.95);
    }
    
    /* Mobile menu */
    .mobile-menu {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .mobile-menu.active {
      opacity: 1;
      visibility: visible;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .container {
        padding-left: 12px;
        padding-right: 12px;
      }
      
      .hbee-card {
        padding: 16px !important;
        margin-bottom: 12px;
      }
      
      .email-link-item {
        padding: 8px 10px;
      }
      
      .email-number {
        min-width: 24px;
        width: 24px;
        height: 24px;
        font-size: 11px;
        margin-right: 10px;
      }
      
      .email-address {
        font-size: 12px;
      }
      
      .email-status {
        font-size: 10px;
      }
      
      h2 {
        font-size: 1.25rem;
      }
      
      h3, h4 {
        font-size: 1rem;
      }
    }
    
    @media (max-width: 480px) {
      body {
        font-size: 13px;
      }
      
      .hbee-btn, .hbee-btn-secondary {
        padding: 10px 16px;
        font-size: 13px;
      }
      
      .hbee-input {
        padding: 8px 12px;
        font-size: 13px;
      }
    }
    
    /* Slide in animation */
    @keyframes slideIn {
      from { transform: translateY(-10px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .slide-in {
      animation: slideIn 0.3s ease forwards;
    }
    
    /* Fix for mobile overflow */
    html, body {
      max-width: 100%;
      overflow-x: hidden;
    }
    
    main {
      max-width: 100%;
      overflow-x: hidden;
    }
    </style>
</head>

<body class="text-gray-800 dark:text-gray-100">
    <!-- Real-time loading line -->
    <div id="loadingLine" class="loading-line"></div>
    
    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white/90 dark:bg-gray-800/90 backdrop-blur-lg border-b border-gray-200 dark:border-gray-700">
        <div class="container mx-auto px-3 py-2">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-br from-primary-500 to-secondary-500 rounded-lg flex items-center justify-center shadow">
                        <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L3 7V17L12 22L21 17V7L12 2Z" fill="currentColor" stroke="white" stroke-width="1.5"/>
                            <path d="M12 12L8 10V14L12 16L16 14V10L12 12Z" fill="white"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold bg-gradient-to-r from-primary-600 to-secondary-500 bg-clip-text text-transparent">
                            Hbee Outreach
                        </h1>
                        <p class="text-xs text-gray-500 dark:text-gray-400">AI Email Tool</p>
                    </div>
                </div>
                
                <!-- Stats -->
                <div class="flex items-center space-x-3">
                    <div class="text-sm font-medium hidden sm:block">
                        <span id="headerSent" class="text-primary-600 dark:text-primary-400">0</span> sent
                    </div>
                    <button id="themeToggle" class="p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        <svg id="lightIcon" class="w-4 h-4 text-gray-600 dark:text-gray-300" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 17C14.7614 17 17 14.7614 17 12C17 9.23858 14.7614 7 12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M12 1V3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M12 21V23" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M4.22 4.22L5.64 5.64" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M18.36 18.36L19.78 19.78" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M1 12H3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M21 12H23" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M4.22 19.78L5.64 18.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M18.36 5.64L19.78 4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg id="darkIcon" class="w-4 h-4 text-gray-600 dark:text-gray-300 hidden" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 12.79C20.8427 14.4922 20.2039 16.1144 19.1582 17.4668C18.1125 18.8192 16.7035 19.8458 15.0957 20.4265C13.4879 21.0073 11.748 21.1181 10.0794 20.7461C8.41085 20.3741 6.8829 19.5345 5.67422 18.3258C4.46554 17.1171 3.62594 15.5892 3.2539 13.9206C2.88186 12.252 2.99274 10.5121 3.57348 8.9043C4.15423 7.29651 5.18085 5.8875 6.53323 4.84182C7.88562 3.79614 9.50782 3.15731 11.21 3C10.2133 4.34827 9.73385 6.00945 9.85852 7.68141C9.9832 9.35338 10.7039 10.9251 11.8894 12.1106C13.0749 13.2961 14.6466 14.0168 16.3186 14.1415C17.9906 14.2662 19.6517 13.7867 21 12.79Z" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-3 py-4">
        <!-- Hero Section -->
        <div class="text-center mb-6">
            <h2 class="text-xl font-bold mb-2">AI-Powered Email Campaigns</h2>
            <p class="text-gray-600 dark:text-gray-400 text-sm">
                Professional bulk email tool with AI templates, smart automation, and real-time analytics
            </p>
        </div>

        <!-- Main Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
            <!-- Left Column - Form & Templates -->
            <div class="lg:col-span-2 space-y-4">
                <!-- Quick Templates Section -->
                <div class="hbee-card p-4">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-semibold flex items-center gap-2 text-sm">
                            <svg class="w-4 h-4 text-accent-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M9.663 17H4.495C3.219 17 2.188 15.969 2.188 14.693V4.496C2.188 3.22 3.22 2.188 4.495 2.188H15.692C16.968 2.188 18 3.22 18 4.496V9.663M7.5 14.5L9.5 16.5L14.5 11.5M21.378 15.622C21.378 18.742 18.856 21.264 15.736 21.264C12.616 21.264 10.094 18.742 10.094 15.622C10.094 12.502 12.616 9.98 15.736 9.98C18.856 9.98 21.378 12.502 21.378 15.622Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            AI Smart Templates
                        </h3>
                        <button id="generateAiTemplate" class="text-xs px-3 py-1 rounded-lg bg-gradient-to-r from-accent-500 to-purple-600 text-white">
                            Generate AI
                        </button>
                    </div>
                    
                    <div class="mb-3">
                        <div class="text-xs font-medium mb-1 text-gray-600 dark:text-gray-400">Category:</div>
                        <div class="flex flex-wrap gap-1">
                            <button data-category="sales" class="template-chip active">Sales</button>
                            <button data-category="followup" class="template-chip">Follow-up</button>
                            <button data-category="networking" class="template-chip">Networking</button>
                        </div>
                    </div>
                    
                    <div id="aiTemplates" class="space-y-2">
                        <!-- Templates loaded here -->
                    </div>
                </div>

                <!-- Campaign Setup -->
                <div class="hbee-card p-4">
                    <div class="flex flex-col md:flex-row md:items-center justify-between mb-4">
                        <h3 class="font-semibold mb-2 md:mb-0 flex items-center gap-2 text-sm">
                            <svg class="w-4 h-4 text-primary-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V6C22 4.89543 21.1046 4 20 4Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M22 7L13.03 12.7C12.7213 12.8934 12.3643 12.996 12 12.996C11.6357 12.996 11.2787 12.8934 10.97 12.7L2 7" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            Campaign Setup
                        </h3>
                        <div class="flex items-center space-x-2">
                            <span class="text-xs px-2 py-0.5 rounded-full bg-green-50 dark:bg-green-900/30 text-green-600 dark:text-green-300">
                                Spam Protected
                            </span>
                        </div>
                    </div>

                    <form id="campaignForm" class="space-y-4">
                        <!-- Quick Templates -->
                        <div class="bg-gradient-to-r from-primary-50 to-secondary-50 dark:from-primary-900/10 dark:to-secondary-900/10 p-3 rounded-lg mb-3">
                            <div class="text-xs font-medium mb-1 text-gray-700 dark:text-gray-300">Quick Templates:</div>
                            <div class="flex flex-wrap gap-1">
                                <button type="button" data-template="professional" class="template-chip">
                                    Professional Intro
                                </button>
                                <button type="button" data-template="followup" class="template-chip">
                                    Follow-up
                                </button>
                                <button type="button" data-template="cold" class="template-chip">
                                    Cold Outreach
                                </button>
                            </div>
                        </div>

                        <!-- Recipients -->
                        <div>
                            <label class="block text-xs font-medium mb-1 flex items-center gap-1">
                                <svg class="w-3 h-3 text-primary-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2"/>
                                    <path d="M9 11C11.2091 11 13 9.20914 13 7C13 4.79086 11.2091 3 9 3C6.79086 3 5 4.79086 5 7C5 9.20914 6.79086 11 9 11Z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Recipients
                            </label>
                            <textarea 
                                id="recipients" 
                                class="hbee-input w-full h-24"
                                placeholder="Enter email addresses (one per line)..."
                                rows="3"
                            ></textarea>
                            <div class="flex justify-between items-center mt-1">
                                <div class="text-xs text-gray-500">
                                    <span id="validCount" class="font-medium">0</span> valid • 
                                    <span id="totalCount" class="font-medium">0</span> total
                                </div>
                                <div class="flex space-x-1">
                                    <button type="button" id="validateBtn" class="text-xs px-2 py-1 rounded bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-300">
                                        Validate
                                    </button>
                                    <button type="button" id="clearBtn" class="text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
                                        Clear
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Subject -->
                        <div>
                            <label class="block text-xs font-medium mb-1 flex items-center gap-1">
                                <svg class="w-3 h-3 text-accent-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 20H21M3 20H4.67454C5.16372 20 5.40831 20 5.63849 19.9447C5.84256 19.8957 6.03765 19.8149 6.2166 19.7053C6.41843 19.5816 6.59138 19.4086 6.93729 19.0627L19.5 6.5C20.3284 5.67157 20.3284 4.32843 19.5 3.5C18.6716 2.67157 17.3284 2.67157 16.5 3.5L3.93726 16.0627C3.59136 16.4086 3.4184 16.5816 3.29472 16.7834C3.18506 16.9624 3.10425 17.1574 3.05526 17.3615C3 17.5917 3 17.8363 3 18.3255V20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Email Subject
                            </label>
                            <input 
                                type="text" 
                                id="subject" 
                                class="hbee-input w-full"
                                placeholder="Subject line - Use {name} and {company}"
                            />
                            <div class="flex flex-wrap gap-1 mt-1">
                                <button type="button" data-subject="Quick question about {company}" class="text-xs px-2 py-0.5 rounded-full bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-300">
                                    Quick Question
                                </button>
                                <button type="button" data-subject="Following up from {company}" class="text-xs px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
                                    Follow Up
                                </button>
                            </div>
                        </div>

                        <!-- Message Body -->
                        <div>
                            <label class="block text-xs font-medium mb-1 flex items-center gap-1">
                                <svg class="w-3 h-3 text-secondary-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" stroke="currentColor" stroke-width="2"/>
                                    <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Message Body
                            </label>
                            <textarea 
                                id="body" 
                                class="hbee-input w-full h-32"
                                placeholder="Write your message... Use {name} for names and {company} for company names"
                                rows="5"
                            ></textarea>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex gap-2 pt-2">
                            <button type="button" id="previewBtn" class="hbee-btn-secondary flex-1 text-sm">
                                Preview
                            </button>
                            <button type="submit" class="hbee-btn flex-1 text-sm">
                                Generate Campaign
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Right Column - Dashboard -->
            <div class="space-y-4">
                <!-- Stats Dashboard -->
                <div class="hbee-card p-4 bg-gradient-to-br from-primary-500 via-primary-600 to-secondary-500 text-white">
                    <h4 class="font-semibold mb-4 text-sm">Campaign Dashboard</h4>
                    
                    <div class="grid grid-cols-2 gap-3 mb-4">
                        <div class="bg-white/10 rounded-lg p-3">
                            <div class="text-xl font-bold" id="statsSent">0</div>
                            <div class="text-xs opacity-80 mt-0.5">Sent</div>
                        </div>
                        <div class="bg-white/10 rounded-lg p-3">
                            <div class="text-xl font-bold" id="statsPending">0</div>
                            <div class="text-xs opacity-80 mt-0.5">Pending</div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="flex justify-between text-xs mb-1">
                            <span>Progress</span>
                            <span id="progressPercent">0%</span>
                        </div>
                        <div class="progress-bar-container">
                            <div id="progressBar" class="progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- Email List -->
                <div class="hbee-card p-4">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold flex items-center gap-2 text-sm">
                            <svg class="w-4 h-4 text-primary-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2"/>
                                <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Email Links
                        </h4>
                        <div class="flex gap-1">
                            <button id="filterAll" class="text-xs px-2 py-0.5 rounded-full bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300">
                                ALL
                            </button>
                            <button id="filterSent" class="text-xs px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                SENT
                            </button>
                            <button id="filterPending" class="text-xs px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                PENDING
                            </button>
                        </div>
                    </div>
                    
                    <!-- Email List Container -->
                    <div id="emailList" class="email-link-list">
                        <div class="text-center py-6 text-gray-500">
                            <svg class="w-10 h-10 mx-auto mb-2 text-gray-300" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V6C22 4.89543 21.1046 4 20 4Z" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M22 7L13.03 12.7C12.7213 12.8934 12.3643 12.996 12 12.996C11.6357 12.996 11.2787 12.8934 10.97 12.7L2 7" stroke="currentColor" stroke-width="1.5"/>
                            </svg>
                            <p class="font-medium">No emails generated</p>
                            <p class="text-xs mt-1">Set up campaign and click "Generate"</p>
                        </div>
                    </div>
                    
                    <!-- Status Summary -->
                    <div class="mt-3 pt-3 border-t border-gray-100 dark:border-gray-700">
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div class="p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20">
                                <div class="text-base font-bold text-primary-600 dark:text-primary-400" id="allCount">0</div>
                                <div class="text-xs text-gray-600 dark:text-gray-400">All</div>
                            </div>
                            <div class="p-2 rounded-lg bg-green-50 dark:bg-green-900/20">
                                <div class="text-base font-bold text-green-600 dark:text-green-400" id="sentCount">0</div>
                                <div class="text-xs text-gray-600 dark:text-gray-400">Sent</div>
                            </div>
                            <div class="p-2 rounded-lg bg-yellow-50 dark:bg-yellow-900/20">
                                <div class="text-base font-bold text-yellow-600 dark:text-yellow-400" id="pendingCount">0</div>
                                <div class="text-xs text-gray-600 dark:text-gray-400">Pending</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between text-xs mt-3 pt-3 border-t border-gray-100 dark:border-gray-700">
                        <button id="exportBtn" class="text-primary-600 dark:text-primary-400 flex items-center">
                            <svg class="w-3 h-3 mr-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2"/>
                                <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Export
                        </button>
                        <button id="clearAllBtn" class="text-red-600 dark:text-red-400 flex items-center">
                            <svg class="w-3 h-3 mr-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 21 17 21H7C6.46957 21 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            Clear All
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="mt-8 py-4 border-t border-gray-200 dark:border-gray-700 bg-white/50 dark:bg-gray-800/50">
        <div class="container mx-auto px-3">
            <div class="text-center text-xs text-gray-600 dark:text-gray-400">
                <p>© <span id="currentYear"></span> Hbee Outreach Tool</p>
                <p class="mt-0.5">Professional email campaign platform</p>
            </div>
        </div>
    </footer>

    <!-- Floating Action Button -->
    <button id="scrollTop" class="fab">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 15L12 8L19 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </button>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    
    <script>
    // Initialize current year
    document.getElementById('currentYear').textContent = new Date().getFullYear();
    
    // Theme Management
    const themeToggle = document.getElementById('themeToggle');
    const lightIcon = document.getElementById('lightIcon');
    const darkIcon = document.getElementById('darkIcon');
    
    function applyTheme(theme) {
        if (theme === 'dark') {
            document.documentElement.classList.add('dark');
            localStorage.setItem('theme', 'dark');
            lightIcon.classList.add('hidden');
            darkIcon.classList.remove('hidden');
        } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', 'light');
            lightIcon.classList.remove('hidden');
            darkIcon.classList.add('hidden');
        }
    }
    
    themeToggle.addEventListener('click', () => {
        const isDark = document.documentElement.classList.contains('dark');
        applyTheme(isDark ? 'light' : 'dark');
    });
    
    // Load saved theme
    const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    applyTheme(savedTheme);
    
    // Global State
    let campaignState = {
        emails: [],
        sentEmails: new Set(),
        currentFilter: 'all',
        subject: '',
        body: '',
        recipients: '',
        campaignId: null,
        isLoading: false
    };
    
    // Save/Load Data
    function saveCampaignData() {
        try {
            const data = {
                emails: campaignState.emails,
                sentEmails: [...campaignState.sentEmails],
                subject: campaignState.subject,
                body: campaignState.body,
                recipients: campaignState.recipients
            };
            localStorage.setItem('hbee_campaign', JSON.stringify(data));
        } catch (e) {
            console.log('Storage save skipped');
        }
    }
    
    function loadCampaignData() {
        try {
            const data = JSON.parse(localStorage.getItem('hbee_campaign'));
            if (data) {
                campaignState.emails = data.emails || [];
                campaignState.sentEmails = new Set(data.sentEmails || []);
                campaignState.subject = data.subject || '';
                campaignState.body = data.body || '';
                campaignState.recipients = data.recipients || '';
                
                elements.subject.value = campaignState.subject;
                elements.body.value = campaignState.body;
                elements.recipients.value = campaignState.recipients;
                
                if (campaignState.emails.length > 0) {
                    generateEmailLinks(campaignState.emails);
                }
                
                updateCounters();
                updateDashboard();
            }
        } catch (e) {
            console.log('No saved data found');
        }
    }
    
    // AI Templates
    const aiTemplates = {
        sales: [
            {
                name: "Sales Pitch",
                subject: "Quick question about {company}'s growth",
                body: "Hi {name},\n\nI noticed {company} is doing impressive work. I have ideas that could help accelerate growth.\n\nWould you have 15 minutes this week for a quick chat?\n\nBest,\n[Your Name]"
            }
        ],
        followup: [
            {
                name: "Follow-up",
                subject: "Following up on my previous email",
                body: "Hi {name},\n\nJust following up on my previous email regarding {company}.\n\nDid you get a chance to review it?\n\nBest,\n[Your Name]"
            }
        ],
        networking: [
            {
                name: "Networking",
                subject: "Connecting from the industry",
                body: "Hi {name},\n\nI came across your profile and was impressed by {company}'s work.\n\nWould you be open to connecting and sharing insights?\n\nBest,\n[Your Name]"
            }
        ]
    };
    
    const quickTemplates = {
        professional: {
            subject: "Introduction from {company}",
            body: "Hi {name},\n\nI'm reaching out from {company} to introduce our services.\n\nWe help businesses like yours achieve goals through innovative solutions.\n\nOpen to a brief call next week?\n\nBest regards,\n[Your Name]"
        },
        followup: {
            subject: "Following up on our conversation",
            body: "Hi {name},\n\nFollowing up on our previous conversation about {company}.\n\nI wanted to share additional thoughts on potential collaboration.\n\nAvailable for a quick chat this week?\n\nBest,\n[Your Name]"
        },
        cold: {
            subject: "Potential opportunity for {company}",
            body: "Hello {name},\n\nI came across {company} and was impressed by your recent achievements.\n\nI believe there might be an opportunity for us to work together.\n\nWould you be interested in exploring this further?\n\nKind regards,\n[Your Name]"
        }
    };
    
    // DOM Elements
    const elements = {
        recipients: document.getElementById('recipients'),
        subject: document.getElementById('subject'),
        body: document.getElementById('body'),
        campaignForm: document.getElementById('campaignForm'),
        emailListContainer: document.getElementById('emailList'),
        loadingLine: document.getElementById('loadingLine')
    };
    
    // Loading Line Functions
    function showLoading(percent) {
        elements.loadingLine.style.width = percent + '%';
    }
    
    function hideLoading() {
        setTimeout(() => {
            elements.loadingLine.style.width = '0%';
        }, 300);
    }
    
    // Initialize AI Templates
    function loadAITemplates(category = 'sales') {
        const templates = aiTemplates[category] || [];
        elements.aiTemplatesContainer = document.getElementById('aiTemplates');
        elements.aiTemplatesContainer.innerHTML = '';
        
        templates.forEach((template, index) => {
            const templateElement = document.createElement('div');
            templateElement.className = 'p-3 rounded border border-gray-200 dark:border-gray-700';
            templateElement.innerHTML = `
                <div class="flex justify-between items-start mb-1">
                    <div class="font-medium text-gray-800 dark:text-gray-200 text-xs">${template.name}</div>
                    <span class="ai-badge text-xs">AI</span>
                </div>
                <div class="text-xs text-gray-600 dark:text-gray-400 mb-2">${template.subject}</div>
                <button class="text-xs text-primary-600 dark:text-primary-400 apply-ai-template" data-index="${index}" data-category="${category}">
                    Apply Template
                </button>
            `;
            elements.aiTemplatesContainer.appendChild(templateElement);
        });
    }
    
    // Load initial templates
    setTimeout(() => {
        loadAITemplates('sales');
    }, 100);
    
    // Template Category Selection
    document.addEventListener('click', function(e) {
        if (e.target.matches('[data-category]')) {
            const category = e.target.dataset.category;
            document.querySelectorAll('[data-category]').forEach(btn => {
                btn.classList.remove('active');
            });
            e.target.classList.add('active');
            loadAITemplates(category);
        }
        
        if (e.target.matches('.apply-ai-template') || e.target.closest('.apply-ai-template')) {
            const button = e.target.matches('.apply-ai-template') ? e.target : e.target.closest('.apply-ai-template');
            const index = parseInt(button.dataset.index);
            const category = button.dataset.category;
            const template = aiTemplates[category][index];
            
            if (template) {
                elements.subject.value = template.subject;
                elements.body.value = template.body;
                campaignState.subject = template.subject;
                campaignState.body = template.body;
                updateCounters();
                showAlert('Template applied', 'success');
            }
        }
        
        if (e.target.matches('[data-template]') || e.target.closest('[data-template]')) {
            const button = e.target.matches('[data-template]') ? e.target : e.target.closest('[data-template]');
            const templateName = button.dataset.template;
            const template = quickTemplates[templateName];
            
            if (template) {
                elements.subject.value = template.subject;
                elements.body.value = template.body;
                campaignState.subject = template.subject;
                campaignState.body = template.body;
                updateCounters();
                showAlert('Template applied', 'success');
            }
        }
        
        if (e.target.matches('[data-subject]') || e.target.closest('[data-subject]')) {
            const button = e.target.matches('[data-subject]') ? e.target : e.target.closest('[data-subject]');
            elements.subject.value = button.dataset.subject;
            campaignState.subject = button.dataset.subject;
            updateCounters();
        }
        
        if (e.target.id === 'generateAiTemplate' || e.target.closest('#generateAiTemplate')) {
            const categories = ['sales', 'followup', 'networking'];
            const randomCategory = categories[Math.floor(Math.random() * categories.length)];
            const templates = aiTemplates[randomCategory];
            const randomTemplate = templates[0];
            
            if (randomTemplate) {
                elements.subject.value = randomTemplate.subject;
                elements.body.value = randomTemplate.body;
                campaignState.subject = randomTemplate.subject;
                campaignState.body = randomTemplate.body;
                updateCounters();
                showAlert('AI template generated', 'success');
            }
        }
    });
    
    // Validation Functions
    function isValidEmail(email) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }
    
    function extractNameFromEmail(email) {
        const namePart = email.split('@')[0] || '';
        const cleanName = namePart.replace(/[._-]/g, ' ');
        return cleanName.split(' ')
            .map(word => word.charAt(0).toUpperCase() + word.slice(1))
            .join(' ') || 'there';
    }
    
    function extractCompanyFromEmail(email) {
        const domain = email.split('@')[1] || '';
        return domain.split('.')[0]?.charAt(0).toUpperCase() + domain.split('.')[0]?.slice(1) || 'Company';
    }
    
    // Update Counters
    function updateCounters() {
        const emails = elements.recipients.value.split('\n').filter(e => e.trim());
        const validEmails = emails.filter(isValidEmail);
        
        document.getElementById('validCount').textContent = validEmails.length;
        document.getElementById('totalCount').textContent = emails.length;
        
        campaignState.subject = elements.subject.value;
        campaignState.body = elements.body.value;
        campaignState.recipients = elements.recipients.value;
        
        saveCampaignData();
    }
    
    // Event Listeners with debouncing
    let saveTimeout;
    function debouncedSave() {
        clearTimeout(saveTimeout);
        saveTimeout = setTimeout(updateCounters, 500);
    }
    
    elements.recipients.addEventListener('input', debouncedSave);
    elements.subject.addEventListener('input', debouncedSave);
    elements.body.addEventListener('input', debouncedSave);
    
    // Validate Emails
    document.getElementById('validateBtn').addEventListener('click', function() {
        const emails = elements.recipients.value.split('\n');
        const validEmails = emails.filter(isValidEmail);
        
        if (emails.some(e => e.trim() && !isValidEmail(e.trim()))) {
            showAlert(`Found ${emails.length - validEmails.length} invalid emails`, 'warning');
            elements.recipients.value = validEmails.join('\n');
            campaignState.recipients = elements.recipients.value;
            updateCounters();
        } else {
            showAlert('All emails are valid!', 'success');
        }
    });
    
    // Clear button
    document.getElementById('clearBtn').addEventListener('click', () => {
        elements.recipients.value = '';
        campaignState.recipients = '';
        updateCounters();
        showAlert('Recipients cleared', 'info');
    });
    
    // Form Submission with real-time loading
    elements.campaignForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const emails = elements.recipients.value.split('\n')
            .map(e => e.trim())
            .filter(e => e && isValidEmail(e));
        
        if (emails.length === 0) {
            showAlert('Please add valid email addresses', 'error');
            return;
        }
        
        if (!elements.subject.value.trim()) {
            showAlert('Please enter a subject line', 'error');
            return;
        }
        
        if (!elements.body.value.trim()) {
            showAlert('Please enter a message body', 'error');
            return;
        }
        
        // Show loading line
        showLoading(10);
        campaignState.isLoading = true;
        
        campaignState.emails = [...new Set(emails)];
        campaignState.recipients = emails.join('\n');
        
        // Generate emails with progress
        await generateEmailLinksWithProgress(campaignState.emails);
        
        // Complete loading
        setTimeout(() => {
            showLoading(100);
            hideLoading();
            campaignState.isLoading = false;
            saveCampaignData();
            showAlert(`Generated ${campaignState.emails.length} email links!`, 'success');
        }, 500);
    });
    
    // Generate emails with progress
    async function generateEmailLinksWithProgress(emails) {
        const emailList = document.getElementById('emailList');
        emailList.innerHTML = '';
        
        if (emails.length === 0) {
            emailList.innerHTML = `
                <div class="text-center py-6 text-gray-500">
                    <svg class="w-10 h-10 mx-auto mb-2 text-gray-300" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V6C22 4.89543 21.1046 4 20 4Z" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M22 7L13.03 12.7C12.7213 12.8934 12.3643 12.996 12 12.996C11.6357 12.996 11.2787 12.8934 10.97 12.7L2 7" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <p class="font-medium">No emails generated</p>
                    <p class="text-xs mt-1">Set up campaign and click "Generate"</p>
                </div>
            `;
            return;
        }
        
        const batchSize = 20;
        const totalBatches = Math.ceil(emails.length / batchSize);
        
        for (let batch = 0; batch < totalBatches; batch++) {
            const start = batch * batchSize;
            const end = Math.min(start + batchSize, emails.length);
            const batchEmails = emails.slice(start, end);
            
            // Update loading progress
            const progress = Math.round(((batch + 1) / totalBatches) * 90) + 10;
            showLoading(progress);
            
            // Process batch
            for (let i = 0; i < batchEmails.length; i++) {
                const email = batchEmails[i];
                const index = start + i;
                createEmailLink(email, index);
            }
            
            // Small delay for smooth animation
            if (batch < totalBatches - 1) {
                await new Promise(resolve => setTimeout(resolve, 50));
            }
        }
        
        updateDashboard();
        applyFilter();
    }
    
    // Create individual email link
    function createEmailLink(email, index) {
        const emailList = document.getElementById('emailList');
        const name = extractNameFromEmail(email);
        const company = extractCompanyFromEmail(email);
        
        const personalizedSubject = campaignState.subject
            .replace(/{name}/g, name)
            .replace(/{company}/g, company);
        
        const personalizedBody = campaignState.body
            .replace(/{name}/g, name)
            .replace(/{company}/g, company);
        
        const encodedSubject = encodeURIComponent(personalizedSubject);
        const encodedBody = encodeURIComponent(personalizedBody).replace(/\n/g, '%0D%0A');
        
        // FIXED: Use mailto: link instead of Gmail URL
        const mailtoLink = `mailto:${email}?subject=${encodedSubject}&body=${encodedBody}`;
        
        const isSent = campaignState.sentEmails.has(email);
        const statusClass = isSent ? 'status-sent' : 'status-pending';
        const statusText = isSent ? 'Sent' : 'Pending';
        
        const linkItem = document.createElement('a');
        linkItem.href = mailtoLink;
        linkItem.className = `email-link-item slide-in ${isSent ? 'sent' : ''}`;
        linkItem.setAttribute('data-email', email);
        linkItem.innerHTML = `
            <div class="email-number">${index + 1}</div>
            <div class="email-content">
                <div class="email-address">${email}</div>
                <div class="email-status ${statusClass}">
                    ${statusText}
                </div>
            </div>
        `;
        
        // Add click handler to mark as sent
        linkItem.addEventListener('click', function(e) {
            if (!campaignState.sentEmails.has(email)) {
                campaignState.sentEmails.add(email);
                this.classList.add('sent');
                this.querySelector('.email-status').className = 'email-status status-sent';
                this.querySelector('.email-status').textContent = 'Sent';
                
                saveCampaignData();
                updateDashboard();
                
                if (campaignState.currentFilter === 'pending') {
                    this.style.display = 'none';
                }
                
                showAlert(`Email opened for ${email}`, 'success');
            }
        });
        
        emailList.appendChild(linkItem);
    }
    
    // Filter Functions
    document.getElementById('filterAll').addEventListener('click', function() {
        campaignState.currentFilter = 'all';
        updateFilterButtons('all');
        applyFilter();
    });
    
    document.getElementById('filterSent').addEventListener('click', function() {
        campaignState.currentFilter = 'sent';
        updateFilterButtons('sent');
        applyFilter();
    });
    
    document.getElementById('filterPending').addEventListener('click', function() {
        campaignState.currentFilter = 'pending';
        updateFilterButtons('pending');
        applyFilter();
    });
    
    function updateFilterButtons(activeFilter) {
        const buttons = ['filterAll', 'filterSent', 'filterPending'];
        buttons.forEach(buttonId => {
            const button = document.getElementById(buttonId);
            if (buttonId === `filter${activeFilter.charAt(0).toUpperCase() + activeFilter.slice(1)}`) {
                button.classList.add('bg-primary-100', 'dark:bg-primary-900/30', 'text-primary-700', 'dark:text-primary-300');
                button.classList.remove('bg-gray-100', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            } else {
                button.classList.remove('bg-primary-100', 'dark:bg-primary-900/30', 'text-primary-700', 'dark:text-primary-300');
                button.classList.add('bg-gray-100', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            }
        });
    }
    
    function applyFilter() {
        const items = document.querySelectorAll('.email-link-item');
        let allCount = 0;
        let sentCount = 0;
        let pendingCount = 0;
        
        items.forEach(item => {
            const email = item.getAttribute('data-email');
            const isSent = campaignState.sentEmails.has(email);
            
            allCount++;
            if (isSent) sentCount++;
            else pendingCount++;
            
            if (campaignState.currentFilter === 'all') {
                item.style.display = 'flex';
            } else if (campaignState.currentFilter === 'sent') {
                item.style.display = isSent ? 'flex' : 'none';
            } else if (campaignState.currentFilter === 'pending') {
                item.style.display = isSent ? 'none' : 'flex';
            }
        });
        
        document.getElementById('allCount').textContent = allCount;
        document.getElementById('sentCount').textContent = sentCount;
        document.getElementById('pendingCount').textContent = pendingCount;
    }
    
    // Update Dashboard
    function updateDashboard() {
        const total = campaignState.emails.length;
        const sent = campaignState.sentEmails.size;
        const pending = total - sent;
        const progress = total > 0 ? Math.round((sent / total) * 100) : 0;
        
        document.getElementById('statsSent').textContent = sent;
        document.getElementById('statsPending').textContent = pending;
        document.getElementById('progressPercent').textContent = `${progress}%`;
        document.getElementById('progressBar').style.width = `${progress}%`;
        document.getElementById('headerSent').textContent = sent;
    }
    
    // Export Emails
    document.getElementById('exportBtn').addEventListener('click', () => {
        if (campaignState.emails.length === 0) {
            showAlert('No emails to export', 'warning');
            return;
        }
        
        let emailsToExport = [];
        if (campaignState.currentFilter === 'all') {
            emailsToExport = campaignState.emails;
        } else if (campaignState.currentFilter === 'sent') {
            emailsToExport = campaignState.emails.filter(email => campaignState.sentEmails.has(email));
        } else if (campaignState.currentFilter === 'pending') {
            emailsToExport = campaignState.emails.filter(email => !campaignState.sentEmails.has(email));
        }
        
        if (emailsToExport.length === 0) {
            showAlert('No emails match the current filter', 'warning');
            return;
        }
        
        let exportData = 'Email Address,Status\n';
        emailsToExport.forEach(email => {
            const status = campaignState.sentEmails.has(email) ? 'Sent' : 'Pending';
            exportData += `${email},${status}\n`;
        });
        
        const blob = new Blob([exportData], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `hbee-emails-${new Date().toISOString().split('T')[0]}.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showAlert(`Exported ${emailsToExport.length} emails`, 'success');
    });
    
    // Clear All
    document.getElementById('clearAllBtn').addEventListener('click', () => {
        if (confirm('Clear all campaign data?')) {
            campaignState = {
                emails: [],
                sentEmails: new Set(),
                currentFilter: 'all',
                subject: '',
                body: '',
                recipients: '',
                campaignId: null,
                isLoading: false
            };
            
            localStorage.removeItem('hbee_campaign');
            elements.recipients.value = '';
            elements.subject.value = '';
            elements.body.value = '';
            
            document.getElementById('emailList').innerHTML = `
                <div class="text-center py-6 text-gray-500">
                    <svg class="w-10 h-10 mx-auto mb-2 text-gray-300" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V6C22 4.89543 21.1046 4 20 4Z" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M22 7L13.03 12.7C12.7213 12.8934 12.3643 12.996 12 12.996C11.6357 12.996 11.2787 12.8934 10.97 12.7L2 7" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <p class="font-medium">No emails generated</p>
                    <p class="text-xs mt-1">Set up campaign and click "Generate"</p>
                </div>
            `;
            
            updateCounters();
            updateDashboard();
            showAlert('All campaign data cleared', 'success');
        }
    });
    
    // Scroll to Top
    window.addEventListener('scroll', () => {
        elements.scrollTop = document.getElementById('scrollTop');
        elements.scrollTop.classList.toggle('visible', window.scrollY > 300);
    });
    
    document.addEventListener('click', function(e) {
        if (e.target.id === 'scrollTop' || e.target.closest('#scrollTop')) {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    });
    
    // Alert System
    function showAlert(message, type = 'info') {
        const existingAlert = document.querySelector('.alert-message');
        if (existingAlert) existingAlert.remove();
        
        const alert = document.createElement('div');
        alert.className = `alert-message fixed top-4 left-4 right-4 mx-auto max-w-md p-3 rounded-lg shadow-lg animate-fadeIn z-50 ${
            type === 'success' ? 'bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300 border border-green-200 dark:border-green-800' :
            type === 'error' ? 'bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300 border border-red-200 dark:border-red-800' :
            type === 'warning' ? 'bg-yellow-50 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-300 border border-yellow-200 dark:border-yellow-800' :
            'bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-300 border border-blue-200 dark:border-blue-800'
        }`;
        
        alert.innerHTML = `
            <div class="flex items-center text-sm">
                <svg class="w-4 h-4 mr-2 flex-shrink-0" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    ${type === 'success' ? 
                        '<path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>' :
                    type === 'error' ?
                        '<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>' :
                    type === 'warning' ?
                        '<path d="M12 9V13M12 17H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>' :
                        '<path d="M13 16H12V12H11M12 8H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>'}
                </svg>
                <span>${message}</span>
            </div>
        `;
        
        document.body.appendChild(alert);
        
        setTimeout(() => {
            alert.style.opacity = '0';
            alert.style.transition = 'opacity 0.3s';
            setTimeout(() => alert.remove(), 300);
        }, 3000);
    }
    
    // Initialize
    window.addEventListener('load', () => {
        loadCampaignData();
        updateFilterButtons('all');
        updateCounters();
        
        if (campaignState.emails.length === 0) {
            setTimeout(() => {
                showAlert('Welcome to Hbee Outreach! Set up your campaign to begin.', 'info');
            }, 1000);
        } else {
            showAlert(`Loaded ${campaignState.emails.length} emails from previous session`, 'success');
        }
    });
    
    // Auto-save on page unload
    window.addEventListener('beforeunload', saveCampaignData);
    
    // Helper function to generate email links (for initial load)
    function generateEmailLinks(emails) {
        const emailList = document.getElementById('emailList');
        emailList.innerHTML = '';
        
        emails.forEach((email, index) => {
            createEmailLink(email, index);
        });
        
        updateDashboard();
        applyFilter();
    }
    </script>
</body>
</html>
